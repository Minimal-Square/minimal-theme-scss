<div class="slideshow {% if section.blocks.size > 1 %} main-carousel js-flickity {% endif %}
{% if section.settings.slideshow_height_mobile == 'small' %}
slideshow__mobile-height--sm
{% elsif section.settings.slideshow_height_mobile == 'medium' %}
slideshow__mobile-height--md
{% elsif section.settings.slideshow_height_mobile == 'large' %}
slideshow__mobile-height--lg
{% elsif section.settings.slideshow_height_mobile == 'extra_large' %}
slideshow__mobile-height--xl
{% elsif section.settings.slideshow_height_mobile == 'fit_screen' %}
slideshow__mobile-height--fit
{% endif %}
{% if section.settings.slideshow_height == 'small' %}
slideshow__desktop-height--sm
{% elsif section.settings.slideshow_height == 'medium' %}
slideshow__desktop-height--md
{% elsif section.settings.slideshow_height == 'large' %}
slideshow__desktop-height--lg
{% elsif section.settings.slideshow_height == 'fit_screen' %}
slideshow__desktop-height--fit
{% endif %}
{% if section.settings.slideshow_width == 'full_width' %}
slideshow__width--full
{% elsif section.settings.slideshow_width == 'content_width' %}
slideshow__width--content
{% endif %}" 
{% unless section.blocks.size == 1 %}
data-flickity='{ "imagesLoaded": true,"wrapAround": true
{% if section.settings.slideshow_autoplay == true %}
, "autoPlay": {{section.settings.slideshow_autoplay_duration}}000 
{% endif %}
}'
{% endunless %}
data-section-type="slideshow" data-section-id="{{ section.id }}">
    {% for block in section.blocks %}
        <div class="carousel-cell slideshow-cell" id="slide-{{forloop.index}}">
            <div class="slideshow-cell--mask">
                {% if block.settings.slideshow_image == blank %}
                <div class="slideshow--placeholder">
                {{ 'lifestyle-1' | placeholder_svg_tag: 'svg-placeholder-slideshow svg-placeholder-opacity' }}
                </div>
                {% else %}
              
                <img src="{{ block.settings.slideshow_image | img_url: 'master' }}" id="desktop_slide_{{forloop.index}}" alt="Slide {{ forloop.index }}" class="slideshow-cell__image 
                {% if block.settings.slideshow_image_position == 'top' %}
                slideshow-cell__image--top
                {% elsif block.settings.slideshow_image_position == 'right' %}
                slideshow-cell__image--right
                {% elsif block.settings.slideshow_image_position == 'center' %}
                slideshow-cell__image--center
                {% elsif block.settings.slideshow_image_position == 'left' %}
                slideshow-cell__image--left
                {% elsif block.settings.slideshow_image_position == 'bottom' %}
                slideshow-cell__image--bottom
                {% endif %}
                ">
                {% unless block.settings.slideshow_image_mobile == blank %}
                    <img src="{{ block.settings.slideshow_image_mobile | img_url: 'master' }}" id="mobile_slide_{{forloop.index}}" alt="Mobile Slide {{ forloop.index }}" class="slideshow-cell__image 
                    {% if block.settings.slideshow_image_position == 'top' %}
                    slideshow-cell__image--top
                    {% elsif block.settings.slideshow_image_position == 'right' %}
                    slideshow-cell__image--right
                    {% elsif block.settings.slideshow_image_position == 'center' %}
                    slideshow-cell__image--center
                    {% elsif block.settings.slideshow_image_position == 'left' %}
                    slideshow-cell__image--left
                    {% elsif block.settings.slideshow_image_position == 'bottom' %}
                    slideshow-cell__image--bottom
                    {% endif %}
                    ">

                    <style>
                        {% unless block.settings.slideshow_image_mobile != blank %}
                        @media only screen and (max-width: 768px) {
                            #desktop_slide_{{forloop.index}} {
                                display: none;
                            }
                        }
                        {% endunless %}
                        @media only screen and (min-width: 768px) {
                            #mobile_slide_{{forloop.index}} {
                                display: none;
                            }
                        }
                    </style>
                {% endunless %}

                <style> 
                    :root {
                        --slide-text-color: {{ block.settings.clr_slideshow_text }};
                    }

                    #shopify-section-{{ section.id }} .flickity-prev-next-button {
                        color: var(--slide-text-color);
                    }

                    #shopify-section-{{ section.id }} .dot {
                        background: var(--slide-text-color) !important;
                    }
                </style>

                {% if block.settings.slideshow_overlay_enable == true %}
                <div class="slideshow-cell__overlay" style="
                {% if block.settings.slideshow_overlay_style == 'solid' %}
                background-color: {{ block.settings.clr_slideshow_overlay }}; 
                {% elsif block.settings.slideshow_overlay_style == 'gradient' %}
                background-image: linear-gradient(rgba(0,0,0,0), {{ block.settings.clr_slideshow_overlay }});
                {% endif %}
                filter: opacity({{ block.settings.slideshow_overlay_opacity }}%);"></div>
                {% endif %}
                {% endif %}
            </div>
            <div class="slideshow-cell--position {% if section.blocks.size > 1 %} slideshow-cell__multiple {% else %} slideshow-cell__single {% endif %}
            {% if block.settings.slideshow_text_position_horizontal == 'top-left' %}
            slideshow-cell--position--top-left
            {% elsif block.settings.slideshow_text_position_horizontal == 'top-center' %}
            slideshow-cell--position--top-center
            {% elsif block.settings.slideshow_text_position_horizontal == 'top-right' %}
            slideshow-cell--position--top-right
            {% elsif block.settings.slideshow_text_position_horizontal == 'center-left' %}
            slideshow-cell--position--center-left
            {% elsif block.settings.slideshow_text_position_horizontal == 'center' %}
            slideshow-cell--position--center
            {% elsif block.settings.slideshow_text_position_horizontal == 'center-right' %}
            slideshow-cell--position--center-right 
            {% elsif block.settings.slideshow_text_position_horizontal == 'bottom-left' %}
            slideshow-cell--position--bottom-left
            {% elsif block.settings.slideshow_text_position_horizontal == 'bottom-center' %}
            slideshow-cell--position--bottom-center
            {% elsif block.settings.slideshow_text_position_horizontal == 'bottom-right' %}
            slideshow-cell--position--bottom-right
            {% endif %}">
                <div class="slideshow-content">
                    <h1 class="slideshow-content__heading" style="color: {{ block.settings.clr_slideshow_text }};">{{ block.settings.slideshow_heading }}</h1>
                    <h2 class="slideshow-content__text" style="color: {{ block.settings.clr_slideshow_text }};">{{ block.settings.slideshow_subheading }}</h2>
                    <div class="space-x-2">
                        {% if block.settings.slideshow_button_text != blank %}
                        <a href="{{ block.settings.slideshow_button_url }}" class="slideshow-content__btn
                        {% if block.settings.slideshow_button_style == 'slideshow_button_style_primary' %}
                        btn-primary
                        {% elsif block.settings.slideshow_button_style == 'slideshow_button_style_secondary' %}
                        btn-secondary
                        {% endif %}">{{ block.settings.slideshow_button_text }}
                        </a>
                        {% endif %}
                        {% if block.settings.slideshow_second_button_text != blank %}
                            <a href="{{ block.settings.slideshow_second_button_url }}" class="slideshow-content__btn
                            {% if block.settings.slideshow_second_button_style == 'slideshow_second_button_style_primary' %}
                            btn-primary
                            {% elsif block.settings.slideshow_second_button_style == 'slideshow_second_button_style_secondary' %}
                            btn-secondary
                            {% endif %}">{{ block.settings.slideshow_second_button_text }}</a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}
</div>

<style>
    #shopify-section-{{ section.id }} .flickity-viewport {
        height: 100%!important;
    }

    #shopify-section-{{ section.id }} .flickity-page-dots {
        position: absolute;
    }

    #shopify-section-{{ section.id }} .slideshow {
        overflow: hidden!important;
    }
</style>

{% javascript %}
    function showAlert() {
        var elem = document.querySelector('.slideshow');
        var flkty = new Flickity( elem, {
        imagesLoaded: true,
        wrapAround: true,
        cellAlign: 'left',
        contain: true
        });
    }
document.addEventListener("shopify:section:load", showAlert());
document.addEventListener("shopify:block:select", showAlert());
{% endjavascript %}

{% schema %}
{
    "name": "Slideshow",
    "max_blocks": 5,
    "blocks": [
        {
            "type": "slideshow",
            "name": "Slide",
            "settings": [
                {
                    "type": "header",
                    "content": "Image"
                },
                {
                    "type": "image_picker",
                    "id": "slideshow_image",
                    "label": "Image",
                    "info": "2048px width recommended"
                },
                {
                    "type": "image_picker",
                    "id": "slideshow_image_mobile",
                    "label": "Image mobile",
                    "info":  "Optional"
                },
                {
                    "type": "select",
                    "id": "slideshow_image_position",
                    "label": "Position",
                    "default": "center",
                    "options": [
                        {
                            "value": "top",
                            "label": "Top"
                        },
                        {
                            "value": "right",
                            "label": "Right"
                        },
                        {
                            "value": "center",
                            "label": "Center"
                        },
                        {
                            "value": "left",
                            "label": "Left"
                        },
                        {
                            "value": "bottom",
                            "label": "Bottom"
                        }
                    ]
                },
                {
                    "type": "header",
                    "content": "Text"
                },
                {
                    "type": "text",
                    "id": "slideshow_heading",
                    "label": "Heading"
                },
                {
                    "type": "textarea",
                    "id": "slideshow_subheading",
                    "label": "Subheading"
                },
                {
                    "type": "color",
                    "id": "clr_slideshow_text",
                    "label": "Text color",
                    "default": "#ffffff"
                },
                {
                    "type": "select",
                    "id": "slideshow_text_position_horizontal",
                    "label": "Position",
                    "default": "center",
                    "options": [
                        {
                            "value": "top-left",
                            "label": "Top Left"
                        },
                        {
                            "value": "top-center",
                            "label": "Top Center"
                        },
                        {
                            "value": "top-right",
                            "label": "Top Right"
                        },
                        {
                            "value": "center-left",
                            "label": "Center Left"
                        },
                        {
                            "value": "center",
                            "label": "Center"
                        },
                        {
                            "value": "center-right",
                            "label": "Center Right"
                        },
                        {
                            "value": "bottom-left",
                            "label": "Bottom Left"
                        },
                        {
                            "value": "bottom-center",
                            "label": "Bottom Center"
                        },
                        {
                            "value": "bottom-right",
                            "label": "Bottom Right"
                        }
                    ]
                },
                {
                    "type": "header",
                    "content": "Buttons"
                },
                {
                    "type": "text",
                    "id": "slideshow_button_text",
                    "label": "Button text",
                    "default": "Shop now"
                },
                {
                    "type": "url",
                    "id": "slideshow_button_url",
                    "label": "Button URL"
                },
                {
                    "type": "select",
                    "id": "slideshow_button_style",
                    "label": "Button style",
                    "default": "slideshow_button_style_primary",
                    "options": [
                        {
                            "value": "slideshow_button_style_primary",
                            "label": "Primary"
                        },
                        {
                            "value": "slideshow_button_style_secondary",
                            "label": "Secondary"
                        }
                    ]
                },
                {
                    "type": "text",
                    "id": "slideshow_second_button_text",
                    "label": "Second button text",
                    "default": "View collection"
                },
                {
                    "type": "url",
                    "id": "slideshow_second_button_url",
                    "label": "Second button URL"
                },
                {
                    "type": "select",
                    "id": "slideshow_second_button_style",
                    "label": "Second button style",
                    "default": "slideshow_second_button_style_secondary",
                    "options": [
                        {
                            "value": "slideshow_second_button_style_primary",
                            "label": "Primary"
                        },
                        {
                            "value": "slideshow_second_button_style_secondary",
                            "label": "Secondary"
                        }
                    ]
                },
                {
                    "type": "header",
                    "content": "Overlay"
                },
                {
                    "type": "checkbox",
                    "default": true,
                    "id": "slideshow_overlay_enable",
                    "label": "Activate overlay"
                    
                },
                {
                    "type": "range",
                    "id": "slideshow_overlay_opacity",
                    "label": "Overlay opacity",
                    "min": 1,
                    "max": 100,
                    "step": 1,
                    "default": 30,
                    "unit": "%"
                },
                {
                    "type": "select",
                    "id": "slideshow_overlay_style",
                    "label": "Overlay style",
                    "default": "solid",
                    "options": [
                        {
                            "value": "solid",
                            "label": "Solid"
                        },
                        {
                            "value": "gradient",
                            "label": "Gradient"
                        }
                        
                    ]
                },
                {
                    "type": "color",
                    "id": "clr_slideshow_overlay",
                    "label": "Overlay color",
                    "default": "#222222"
                }
            ]
        }
    ],
    "settings": [
        {
            "type": "header",
            "content": "Layout"
        },
        {
            "type": "select",
            "id": "slideshow_width",
            "label": "Slideshow width",
            "default": "full_width",
            "options": [
                {
                    "value": "full_width",
                    "label": "Full width"
                },
                {
                    "value": "content_width",
                    "label": "Content width"
                }
            ]
        },
        {
            "type": "select",
            "id": "slideshow_height",
            "label": "Slideshow height desktop",
            "default": "large",
            "options": [
                {
                    "value": "small",
                    "label": "Small"
                },
                {
                    "value": "medium",
                    "label": "Medium"
                },
                {
                    "value": "large",
                    "label": "Large"
                },
                {
                    "value": "fit_screen",
                    "label": "Fit screen"
                }
            ]
        },
        {
            "type": "select",
            "id": "slideshow_height_mobile",
            "label": "Slideshow height mobile",
            "default": "large",
            "options": [
                {
                    "value": "small",
                    "label": "Small"
                },
                {
                    "value": "medium",
                    "label": "Medium"
                },
                {
                    "value": "large",
                    "label": "Large"
                },
                {
                    "value": "extra_large",
                    "label": "Extra large"
                },
                {
                    "value": "fit_screen",
                    "label": "Fit screen"
                }
            ]
        },
        {
            "type": "header",
            "content": "Autoplay"
        },
        {
            "type": "checkbox",
            "id": "slideshow_autoplay_activate",
            "label": "Activate autoplay"
        },
        {
            "type": "range",
            "id": "slideshow_autoplay_duration",
            "label": "Autoplay slide duration",
            "min": 5,
            "max": 12,
            "step": 1,
            "default": 5,
            "unit": "sec"
        }
    ],
    "presets": [
        {
            "category": "Image",
            "name":"Slideshow"
        }
    ]
}
{% endschema %}